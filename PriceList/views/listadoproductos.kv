<ListadoProductosScreen>:
    canvas:
        Color:
            rgba: 0.98, 0.98, 0.98, 1
        Rectangle:
            size: self.size
            pos: self.pos
    
    BoxLayout:
        orientation: 'vertical'
        padding: dp(20)
        spacing: dp(20)
        
        Label:
            text: "Familia Final"
            font_size: '28sp'
            bold: True
            color: 0.2, 0.2, 0.2, 1
            size_hint_y: 0.12
            halign: 'center'
            valign: 'middle'
            canvas.before:
                Color:
                    rgba: 0.25, 0.65, 0.45, 1
                Rectangle:
                    size: self.width, dp(4)
                    pos: self.x, self.y - dp(5)
        
        BoxLayout:
            orientation: 'vertical'
            spacing: dp(2)
            
            # Encabezados fijos
            GridLayout:
                cols: 5
                size_hint_y: None
                height: dp(50)
                spacing: dp(2)
                padding: dp(10)
                
                Label:
                    text: "Producto"
                    bold: True
                    font_size: '18sp'
                    color: 0.3, 0.3, 0.3, 1
                    canvas.before:
                        Color:
                            rgba: 0.9, 0.9, 0.9, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size
                
                Label:
                    text: "Precio"
                    bold: True
                    font_size: '18sp'
                    color: 0.3, 0.3, 0.3, 1
                    canvas.before:
                        Color:
                            rgba: 0.9, 0.9, 0.9, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size
                
                Label:
                    text: "Máximo"
                    bold: True
                    font_size: '18sp'
                    color: 0.3, 0.3, 0.3, 1
                    canvas.before:
                        Color:
                            rgba: 0.9, 0.9, 0.9, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size
                
                Label:
                    text: "Mínimo"
                    bold: True
                    font_size: '18sp'
                    color: 0.3, 0.3, 0.3, 1
                    canvas.before:
                        Color:
                            rgba: 0.9, 0.9, 0.9, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size
                
                Label:
                    text: "Media"
                    bold: True
                    font_size: '18sp'
                    color: 0.3, 0.3, 0.3, 1
                    canvas.before:
                        Color:
                            rgba: 0.9, 0.9, 0.9, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size
            
            # Tabla con RecycleView
            RecycleView:
                id: rv
                key_viewclass: 'viewclass'
                bar_width: dp(10)
                bar_color: 0.7, 0.7, 0.7, 1
                
                RecycleBoxLayout:
                    orientation: 'vertical'
                    default_size: None, dp(50)
                    default_size_hint: 1, None
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(2)